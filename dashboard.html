<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>SkinClinic</title>

<script
 src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js">
</script>

<link rel="stylesheet" href="./js/css/style.css">

<!-- Chart.js 4 (UMD com todos os componentes: linear, doughnut, bar) -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4/dist/chart.umd.min.js"></script>

</head>

<body>

<div class="app-wrapper">

  <!-- SIDEBAR (menu lateral ‚Äì abre/fecha) -->
  <aside class="sidebar" id="sidebar" aria-label="Menu principal">
    <div class="sidebar-header">
      <span class="sidebar-logo" id="sidebarLogo" data-fallback="SkinClinic">SkinClinic</span>
      <button type="button" class="sidebar-toggle" id="sidebarToggle" aria-label="Abrir/fechar menu" title="Abrir/fechar menu">
        <span class="sidebar-toggle-icon" aria-hidden="true"></span>
      </button>
    </div>

    <nav class="sidebar-nav">
      <ul class="sidebar-menu">
        <li><button type="button" class="sidebar-item active" data-view="dashboard" title="Dashboard"><span class="sidebar-icon">üìä</span><span class="sidebar-label">Dashboard</span></button></li>
        <li class="sidebar-cadastrar-wrap" id="cadastrarWrap">
          <button type="button" class="sidebar-item sidebar-item-parent" id="btnCadastrar" data-cadastrar-parent aria-expanded="false" title="Cadastrar">
            <span class="sidebar-icon sidebar-icon-user-plus" aria-hidden="true">
              <span class="icon-user">üë§</span>
              <span class="icon-plus-badge">‚ûï</span>
            </span>
            <span class="sidebar-label">Cadastrar</span>
            <span class="sidebar-chevron" aria-hidden="true">‚ñæ</span>
          </button>
          <ul class="sidebar-submenu" id="cadastrarSubmenu">
            <li><button type="button" class="sidebar-item sidebar-subitem" data-view="clientes" data-cadastrar-child title="Clientes"><span class="sidebar-icon">üë§</span><span class="sidebar-label">Clientes</span></button></li>
            <li><button type="button" class="sidebar-item sidebar-subitem" data-view="team" data-cadastrar-child title="Equipe"><span class="sidebar-icon">üë•</span><span class="sidebar-label">Equipe</span></button></li>
          </ul>
        </li>
        <li><button type="button" class="sidebar-item" data-view="agenda" title="Agenda"><span class="sidebar-icon">üìÖ</span><span class="sidebar-label">Agenda</span></button></li>
        <li><button type="button" class="sidebar-item" data-view="procedimento" title="Procedimentos e precifica√ß√£o"><span class="sidebar-icon">ü©∫</span><span class="sidebar-label">Procedimentos</span></button></li>
        <li><button type="button" class="sidebar-item" data-view="financeiro" title="Financeiro"><span class="sidebar-icon">üí∞</span><span class="sidebar-label">Financeiro</span></button></li>
        <li class="sidebar-divider"></li>
        <li class="sidebar-marketing-wrap" id="marketingWrap">
          <button type="button" class="sidebar-item sidebar-item-parent" id="btnMarketing" data-marketing-parent aria-expanded="false" title="Marketing">
            <span class="sidebar-icon">üì¢</span><span class="sidebar-label">Marketing</span>
            <span class="sidebar-chevron" aria-hidden="true">‚ñæ</span>
          </button>
          <ul class="sidebar-submenu" id="marketingSubmenu">
            <li><button type="button" class="sidebar-item sidebar-subitem" data-view="marketing" title="Sugest√µes e m√©tricas"><span class="sidebar-icon">üì¢</span><span class="sidebar-label">Sugest√µes</span></button></li>
            <li><button type="button" class="sidebar-item sidebar-subitem" data-view="calendario-conteudo" title="Calend√°rio de conte√∫do"><span class="sidebar-icon">üìÜ</span><span class="sidebar-label">Calend√°rio</span></button></li>
          </ul>
        </li>
        <li><button type="button" class="sidebar-item" data-view="estoque" title="Estoque"><span class="sidebar-icon">üì¶</span><span class="sidebar-label">Estoque</span></button></li>
        <li id="menuWrapAnamnese" class="menu-item-hidden"><button type="button" class="sidebar-item" data-view="anamnese" title="Ficha de Anamnese"><span class="sidebar-icon">üìã</span><span class="sidebar-label">Anamnese</span></button></li>
        <li><button type="button" class="sidebar-item" data-view="skincare" title="Skincare"><span class="sidebar-icon">‚ú®</span><span class="sidebar-label">Skincare</span></button></li>
        <li><button type="button" class="sidebar-item" data-view="protocolo" title="Protocolo"><span class="sidebar-icon">üìã</span><span class="sidebar-label">Protocolo</span></button></li>
        <li><button type="button" class="sidebar-item" data-view="estudo-caso" title="Estudo de caso"><span class="sidebar-icon">üìö</span><span class="sidebar-label">Estudo de caso</span></button></li>
        <li><button type="button" class="sidebar-item" data-view="ocr" title="Notas fiscais ‚Äî emiss√£o"><span class="sidebar-icon">üìÑ</span><span class="sidebar-label">Notas fiscais</span></button></li>
        <li class="sidebar-divider"></li>
        <li><button type="button" class="sidebar-item" data-view="export" title="Exportar e importar dados" aria-label="Exportar e importar dados"><span class="sidebar-icon">üì§</span><span class="sidebar-label">Exportar e importar</span></button></li>
        <li><button type="button" class="sidebar-item" data-view="para-clinicas" title="Para cl√≠nicas ‚Äî ajuda e posicionamento"><span class="sidebar-icon">üìñ</span><span class="sidebar-label">Para cl√≠nicas</span></button></li>
        <li class="admin-only"><button type="button" class="sidebar-item" data-view="master" title="Configura√ß√µes da organiza√ß√£o"><span class="sidebar-icon">‚öôÔ∏è</span><span class="sidebar-label">Configura√ß√µes</span></button></li>
      </ul>
    </nav>

    <div class="sidebar-footer">
      <button type="button" class="sidebar-item" id="btnTutorialIniciar" title="Passo a passo para conhecer o app">üìñ <span class="sidebar-label">Tutorial</span></button>
      <button type="button" class="sidebar-item" id="btnTheme" title="Tema">üåô</button>
      <button type="button" class="sidebar-item sidebar-item-logout" id="btnLogout" title="Sair">üö™ <span class="sidebar-label">Sair</span></button>
      <p class="sidebar-powered" id="sidebarPowered" aria-hidden="true">Powered by <strong>SkinClinic</strong></p>
    </div>
  </aside>

  <!-- CONTE√öDO PRINCIPAL -->
  <div class="main-content">
    <header class="main-header">
      <div class="main-header-top">
        <div>
          <h1 id="mainHeaderTitle">SkinClinic</h1>
          <p id="headerViewTitle">Sistema Inteligente</p>
        </div>
        <div class="main-header-actions">
          <button type="button" id="btnNotifBell" class="notif-bell" aria-label="Notifica√ß√µes" title="Se apareceu um n√∫mero ali, vale a pena clicar.">
            <span class="notif-bell-icon" aria-hidden="true">üîî</span>
            <span id="badgeNotif" class="notif-bell-badge hidden" aria-live="polite">0</span>
          </button>
        </div>
      </div>
      <div class="stats-grid" id="dashboardStatsGrid">
        <div class="stat-card" id="statCardClientes" data-metric="clientes">
          <div class="stat-label" id="statLabelClientes">Clientes</div>
          <div class="stat-value" id="mClientes">0</div>
        </div>
        <div class="stat-card" id="statCardAgenda" data-metric="agenda">
          <div class="stat-label" id="statLabelAgenda">Agenda hoje</div>
          <div class="stat-value" id="mAgenda">0</div>
        </div>
        <div class="stat-card" id="statCardSaldo" data-metric="saldo">
          <div class="stat-label">Saldo</div>
          <div class="stat-value" id="mSaldo">R$ 0</div>
        </div>
        <div class="stat-card hidden" id="statCardPrevisto" data-metric="previsto">
          <div class="stat-label" id="statLabelPrevisto">Meu previsto hoje</div>
          <div class="stat-value" id="mPrevisto">R$ 0</div>
        </div>
      </div>
    </header>

    <div id="notifPanel" class="notif-panel hidden" role="dialog" aria-label="Notifica√ß√µes" aria-modal="false">
      <div class="notif-panel-header">
        <span class="notif-panel-title">Notifica√ß√µes</span>
        <button type="button" class="notif-panel-close" id="notifPanelClose" aria-label="Fechar">√ó</button>
      </div>
      <div id="notifPanelList" class="notif-panel-list"></div>
      <div class="notif-panel-footer">
        <button type="button" id="notifPanelVerTodas" class="notif-panel-ver-todas">Ver todas</button>
      </div>
    </div>

    <main id="mainContent" class="content-area" tabindex="-1">
      <div id="viewLoadingOverlay" class="view-loading-overlay hidden" aria-live="polite" aria-busy="false">
        <div class="view-loading-spinner"></div>
        <span>Carregando...</span>
      </div>
      <!-- Todas as views com class="view" para o SPA mostrar s√≥ uma por vez -->

      <section id="view-dashboard" class="view">
        <div class="filter-bar">
          <label for="filterPeriod" class="sr-only">Per√≠odo</label>
          <select id="filterPeriod" aria-label="Per√≠odo do dashboard">
            <option value="today">Hoje</option>
            <option value="week">Semana</option>
            <option value="month">M√™s</option>
            <option value="custom">Personalizado</option>
          </select>
          <input type="date" id="startDate" hidden aria-label="Data inicial">
          <input type="date" id="endDate" hidden aria-label="Data final">
          <button type="button" id="applyFilter" class="btn-secondary">Aplicar</button>
        </div>
        <div class="dashboard-protocolos-dia" id="dashboardProtocolosDia">
          <h3 class="dashboard-protocolos-dia-title">Protocolos aplicados hoje</h3>
          <div id="dashboardProtocolosDiaList" class="dashboard-protocolos-dia-list"></div>
        </div>
        <canvas id="chartFinanceiro"></canvas>
        <canvas id="chartAgenda"></canvas>
      </section>

      <section id="view-export" class="view hidden">
        <div class="view-header">
          <h2>Exportar e importar dados</h2>
          <p class="view-lead">Exporte por tipo (CSV) ou use importa√ß√£o em lote para migrar clientes, procedimentos, financeiro e agenda. Para backup completo e restaura√ß√£o, use <a href="#" data-view="backup">Backup</a> no menu.</p>
        </div>
        <div class="export-import-grid">
          <div class="view-card export-block">
            <h3 class="view-card-title">Exportar</h3>
            <button type="button" id="btnExportClientes" class="btn-primary">Clientes (CSV)</button>
            <button type="button" id="btnExportFinanceiro" class="btn-primary">Financeiro (CSV)</button>
            <button type="button" id="btnExportBackupJson" class="btn-secondary" title="Arquivo √∫nico para restaurar depois">Backup completo</button>
          </div>
          <div class="view-card import-block">
            <h3 class="view-card-title">Importar em lote (CSV)</h3>
            <label for="importTipo">Tipo de dados</label>
            <select id="importTipo">
              <option value="clientes">Clientes</option>
              <option value="procedimentos">Procedimentos</option>
              <option value="custo_fixo">Tabela de custo fixo</option>
              <option value="financeiro">Planilha financeira</option>
              <option value="agenda">Agenda de clientes</option>
            </select>
            <p class="view-hint import-duplicados-hint">Em caso de duplicado (e-mail, CPF ou nome):</p>
            <label class="import-opcao-duplicado">
              <input type="radio" name="importDuplicados" value="pular" checked>
              Pular duplicados
            </label>
            <label class="import-opcao-duplicado">
              <input type="radio" name="importDuplicados" value="todas">
              Importar todas (revisar erros depois)
            </label>
            <div class="import-actions">
              <a href="#" id="btnDownloadTemplate" class="btn-secondary">Baixar modelo CSV</a>
              <label for="importFile" class="sr-only">Selecionar arquivo CSV para importar</label>
              <input type="file" id="importFile" accept=".csv,text/csv,application/csv" class="import-file" aria-label="Arquivo CSV para importar">
              <button type="button" id="btnImportarLote" class="btn-primary">Importar</button>
            </div>
            <div id="importResult" class="import-result hidden"></div>
          </div>
        </div>
        <div class="export-backup-unico">
          <h3 class="export-backup-unico-title">Backup √∫nico (outro sistema) <span class="info-icon" title="Se o outro sistema exportar todos os dados em um √∫nico arquivo JSON, use aqui. Formato: clientes, procedimentos, financeiro, agenda. Cada chave √© um array de objetos com os mesmos campos dos CSV (nome, email, etc.)." aria-label="Informa√ß√£o">‚ÑπÔ∏è</span></h3>
          <p class="export-backup-hint">Se o outro sistema exportar <strong>todos os dados em um √∫nico arquivo JSON</strong>, use aqui. Formato: <code>{ "clientes": [...], "procedimentos": [...], "financeiro": [...], "agenda": [...] }</code>. Cada chave √© um array de objetos com os mesmos campos dos CSV (nome, email, etc.).</p>
          <label for="importBackupFile" class="sr-only">Selecionar arquivo JSON de backup</label>
          <input type="file" id="importBackupFile" accept=".json,application/json" class="import-file" aria-label="Arquivo JSON de backup">
          <button type="button" id="btnRestaurarBackup" class="btn-primary">Restaurar backup</button>
          <div id="importBackupResult" class="import-result hidden"></div>
        </div>
        <div class="export-relatorio-procedimentos">
          <h3>Relat√≥rio: procedimentos realizados por per√≠odo</h3>
          <p class="export-relatorio-hint">Quantidade de agendamentos por procedimento em um intervalo de datas.</p>
          <div class="export-relatorio-filtros">
            <label for="relatorioProcStart">De</label>
            <input type="date" id="relatorioProcStart" aria-label="Data inicial">
            <label for="relatorioProcEnd">At√©</label>
            <input type="date" id="relatorioProcEnd" aria-label="Data final">
            <label for="relatorioProcProfessional">Profissional</label>
            <select id="relatorioProcProfessional" aria-label="Filtrar por profissional"><option value="">Todos</option></select>
            <label for="relatorioProcProcedure">Procedimento</label>
            <select id="relatorioProcProcedure" aria-label="Filtrar por procedimento"><option value="">Todos</option></select>
            <button type="button" id="btnRelatorioProcedimentos" class="btn-primary">Gerar relat√≥rio</button>
          </div>
          <div id="relatorioProcedimentosResult" class="relatorio-procedimentos-result hidden"></div>
        </div>
      </section>

      <section id="view-planos" class="view hidden">
        <div class="view-header">
          <h2>Planos</h2>
          <p class="view-lead">Propostas comerciais (pacotes, assinaturas). Vincule procedimentos e use o simulador de recebimento para ver margem por forma de pagamento.</p>
        </div>
        <div class="view-card">
          <div id="listaPlanos"></div>
        </div>
      </section>

      <section id="view-empresa" class="view hidden">
        <div class="empresa-header">
          <h2>Cadastro da empresa</h2>
          <p class="empresa-lead">Informa√ß√µes da cl√≠nica usadas em todo o sistema e na identidade visual.</p>
        </div>
        <div id="empresaResumo" class="empresa-resumo hidden">
          <div class="empresa-resumo-content"></div>
          <button type="button" id="empresaBtnEditar" class="btn-primary">Editar cadastro</button>
        </div>
        <form id="empresaForm" class="empresa-form">
          <section class="empresa-card" aria-labelledby="empresa-identidade-title">
            <h3 id="empresa-identidade-title" class="empresa-card-title">Identidade</h3>
            <div class="empresa-field">
              <label for="empresaNome">Nome</label>
              <input type="text" id="empresaNome" placeholder="Nome da cl√≠nica">
            </div>
            <div class="empresa-field">
              <label for="empresaCidade">Cidade e estado</label>
              <div class="empresa-row">
                <input type="text" id="empresaCidade" placeholder="Cidade">
                <input type="text" id="empresaEstado" placeholder="UF" maxlength="2">
              </div>
            </div>
            <div class="empresa-field empresa-field-logo">
              <label>Logo</label>
              <div class="empresa-logo-upload-area">
                <input type="file" id="empresaLogoFile" accept="image/png,image/jpeg,image/webp,image/gif,image/svg+xml" class="empresa-logo-file-input">
                <label for="empresaLogoFile" class="empresa-logo-import-btn">
                  <span class="empresa-logo-import-icon">üì∑</span>
                  <span>Importar imagem</span>
                </label>
                <p class="empresa-logo-hint">PNG ou WEBP, quadrado (ex.: 512√ó512px). M√°x. ~500 KB.</p>
              </div>
              <div id="empresaLogoPreview" class="empresa-logo-preview" aria-live="polite"></div>
              <details class="empresa-logo-url-details">
                <summary>Ou informar URL da imagem</summary>
                <input type="url" id="empresaLogoUrl" placeholder="https://‚Ä¶">
              </details>
            </div>
            <div class="empresa-field">
              <label for="empresaTelefone">Telefone</label>
              <input type="tel" id="empresaTelefone" placeholder="Telefone da empresa">
            </div>
          </section>
          <section class="empresa-card" aria-labelledby="empresa-fiscal-title">
            <h3 id="empresa-fiscal-title" class="empresa-card-title">Endere√ßo e dados fiscais</h3>
            <div class="empresa-field empresa-field-cep">
              <label for="empresaCep">CEP</label>
              <span class="info-icon" title="Informe o CEP e clique em Buscar para preencher automaticamente cidade, estado e endere√ßo." aria-hidden="true">‚ÑπÔ∏è</span>
              <div class="empresa-cep-wrap">
                <input type="text" id="empresaCep" placeholder="00000-000" maxlength="9" inputmode="numeric">
                <button type="button" id="empresaCepBuscar" class="btn-secondary btn-sm empresa-cep-buscar" title="Buscar endere√ßo pelo CEP">Buscar</button>
              </div>
            </div>
            <div class="empresa-field">
              <label for="empresaEndereco">Endere√ßo</label>
              <input type="text" id="empresaEndereco" placeholder="Endere√ßo completo">
            </div>
            <div class="empresa-field">
              <label for="empresaComplemento">Complemento</label>
              <span class="info-icon" title="Ex.: sala, bloco, conjunto. Ajuda a localizar a cl√≠nica." aria-hidden="true">‚ÑπÔ∏è</span>
              <input type="text" id="empresaComplemento" placeholder="Apto, sala, bloco‚Ä¶">
            </div>
            <div class="empresa-field">
              <label for="empresaCnpj">CNPJ</label>
              <input type="text" id="empresaCnpj" placeholder="CNPJ">
            </div>
            <div class="empresa-field">
              <label for="empresaNotaFiscalEmitirUrl">Link para emitir nota fiscal</label>
              <input type="url" id="empresaNotaFiscalEmitirUrl" placeholder="https://‚Ä¶ (sistema da prefeitura ou contador)">
              <span class="empresa-hint-inline">Aparece em Notas fiscais ‚Üí Emitir nota fiscal.</span>
            </div>
          </section>
          <section class="empresa-card empresa-card-preferences" aria-labelledby="empresa-prefs-title">
            <h3 id="empresa-prefs-title" class="empresa-card-title">Prefer√™ncias</h3>
            <p class="empresa-preferences-intro">Como o menu e as mensagens de anivers√°rio se comportam para a sua equipe.</p>
            <div class="empresa-preferences-grid">
              <label class="empresa-toggle">
                <input type="checkbox" id="empresaMenuAnamnese">
                <span class="empresa-toggle-text">Mostrar &quot;Anamnese&quot; no menu</span>
              </label>
              <label class="empresa-toggle">
                <input type="checkbox" id="empresaBrindeAniversario">
                <span class="empresa-toggle-text">Incluir brinde no texto de anivers√°rio</span>
              </label>
            </div>
            <p class="empresa-preferences-note">Anamnese continua acess√≠vel pelo perfil do cliente e pela agenda. Brinde: o texto sugerido em Agenda ‚Üí Aniversariantes passa a incluir oferta; a empresa decide se oferece.</p>
          </section>
          <div class="empresa-form-actions">
            <button type="submit" id="empresaBtnSalvar" class="btn-primary">Salvar</button>
          </div>
        </form>
        <section class="empresa-card empresa-salas-block" aria-labelledby="empresa-salas-title">
          <h3 id="empresa-salas-title" class="empresa-card-title">Salas e capacidade</h3>
          <p class="empresa-salas-hint">Cadastre salas e cabines e os tipos de procedimento que cada uma suporta. Na agenda, s√≥ aparecem salas compat√≠veis com o procedimento escolhido.</p>
          <div class="empresa-salas-actions">
            <p id="empresaSalasCount" class="empresa-salas-count">0 sala(s) cadastrada(s)</p>
            <div class="empresa-salas-buttons">
              <button type="button" id="empresaBtnNovaSala" class="btn-primary">+ Nova sala</button>
              <button type="button" id="empresaBtnGerenciarSalas" class="btn-secondary">Atualizar lista</button>
            </div>
          </div>
          <div id="empresaSalasLista" class="empresa-salas-lista"></div>
        </section>
      </section>

      <section id="view-team" class="view hidden">
        <div class="view-team-header">
          <h2>Equipe</h2>
          <button type="button" id="btnInvite" class="btn-primary">+ Convidar usu√°rio</button>
        </div>
        <p class="view-lead view-team-google-hint">Conecte a agenda Google de cada membro para ver disponibilidade ao criar agendamentos.</p>
        <div id="listaTeam"></div>
        <div id="teamPaymentWrap" class="view-card team-payment-wrap hidden">
          <h3 class="view-card-title team-payment-title">Modelo de pagamento (master)</h3>
          <p class="view-hint team-payment-hint">Registro para an√°lise financeira. N√£o executa pagamento nem exp√µe valores em telas operacionais.</p>
          <div id="listaTeamPayment" class="lista-team-payment"></div>
        </div>
        <div id="teamAfazeresWrap" class="view-card team-afazeres-wrap">
          <h3 class="view-card-title team-afazeres-title">Afazeres</h3>
          <p class="view-hint team-afazeres-hint">Tarefas com respons√°vel e prazo; n√£o ocupam a agenda de atendimento.</p>
          <button type="button" id="btnNovoAfazer" class="btn-secondary">+ Novo afazer</button>
          <div id="listaAfazeres" class="lista-afazeres"></div>
        </div>
        <div id="teamIndiceCuidadoWrap" class="view-card team-indice-cuidado-wrap">
          <h3 class="view-card-title team-indice-cuidado-title">√çndice de cuidado</h3>
          <p class="view-hint team-indice-cuidado-hint">Avalia√ß√µes de produtos pelos profissionais; refer√™ncia para bonifica√ß√£o e engajamento.</p>
          <div id="listaIndiceCuidado" class="lista-indice-cuidado"></div>
        </div>
      </section>

      <section id="view-clientes" class="view hidden">
        <div class="view-clientes-header">
          <h2>Clientes</h2>
          <div class="view-clientes-actions">
            <button type="button" id="btnNovoCliente" class="btn-primary">Adicionar cliente</button>
            <details class="clientes-import-details">
              <summary class="btn-secondary clientes-import-summary" title="Usado no in√≠cio para migrar muitos clientes de uma vez">Importar em lote</summary>
              <div class="clientes-import-dropdown">
                <input type="file" id="importClientesFile" accept=".csv,text/csv,application/csv" class="hidden" aria-label="Selecionar CSV">
                <label class="import-opcao-inline" title="Desmarque para importar todas; duplicadas aparecer√£o como erro para revisar">
                  <input type="checkbox" id="clientesPularDuplicados" checked> Pular duplicados
                </label>
                <button type="button" id="btnImportarClientes" class="btn-secondary btn-sm" title="Selecionar arquivo CSV">Selecionar CSV</button>
                <a href="#" id="btnModeloClientes" class="btn-link" title="Baixar modelo CSV">Modelo CSV</a>
              </div>
            </details>
          </div>
        </div>
        <div class="view-clientes-toolbar">
          <label for="clientesSearch" class="sr-only">Buscar clientes</label>
          <input type="search" id="clientesSearch" placeholder="Buscar por nome, telefone ou e-mail" class="clientes-search" aria-label="Buscar por nome, telefone ou e-mail">
          <label for="clientesFilterState" class="sr-only">Estado do cliente</label>
          <select id="clientesFilterState" class="clientes-filter" aria-label="Filtrar por estado do cliente">
            <option value="">Todos os estados</option>
            <option value="em_acompanhamento">Em acompanhamento</option>
            <option value="pre_cadastro">Pr√©-cadastro</option>
            <option value="pausado">Pausado</option>
            <option value="alta">Alta</option>
            <option value="arquivado">Arquivado</option>
          </select>
        </div>
        <div class="clientes-table-wrap">
          <table class="clientes-table" id="clientesTable">
            <thead>
              <tr>
                <th>Nome</th>
                <th>Estado</th>
                <th>Contato</th>
                <th>Cria√ß√£o</th>
                <th class="clientes-col-acoes">A√ß√µes</th>
              </tr>
            </thead>
            <tbody id="listaClientes"></tbody>
          </table>
        </div>
        <p id="clientesEmpty" class="clientes-empty hidden">Nenhum cliente encontrado.</p>
      </section>

      <section id="view-cliente-perfil" class="view hidden">
        <div id="clientePerfilContent"></div>
      </section>

      <section id="view-agenda" class="view hidden">
        <div class="agenda-layout">
          <div class="agenda-calendar-wrap">
            <div class="agenda-calendar-header">
              <button type="button" id="agendaPrevMonth" class="btn-icon" title="M√™s anterior">‚Äπ</button>
              <h2 id="agendaMonthTitle" class="agenda-month-title">‚Äî</h2>
              <button type="button" id="agendaNextMonth" class="btn-icon" title="Pr√≥ximo m√™s">‚Ä∫</button>
            </div>
            <button type="button" id="agendaGoToday" class="btn-secondary agenda-go-today">Hoje</button>
            <div id="agendaCalendar" class="agenda-calendar" role="grid" aria-label="Calend√°rio mensal"></div>
          </div>
          <div class="agenda-day-wrap">
            <div class="agenda-day-header">
              <h3 id="agendaDayTitle" class="agenda-day-title">Agendamentos do dia</h3>
              <div class="agenda-day-actions">
                <input type="file" id="importAgendaFile" accept=".csv,text/csv,application/csv" class="hidden" aria-label="Selecionar CSV">
                <button type="button" id="btnImportarAgenda" class="btn-secondary" title="Importar agenda (CSV)">üì• Importar CSV</button>
            <a href="#" id="btnModeloAgenda" class="btn-link" title="Baixar modelo CSV">Modelo CSV</a>
                <button type="button" id="btnNovoAgendamento" class="btn-primary">+ Novo agendamento</button>
              </div>
            </div>
            <div id="listaAgenda" class="lista-agenda"></div>
            <div id="agendaAniversariantesWrap" class="agenda-aniversariantes-wrap">
              <h3 class="agenda-aniversariantes-title">Aniversariantes</h3>
              <p class="agenda-aniversariantes-hint">Clientes que fazem anivers√°rio hoje ou nesta semana. Envie uma mensagem (ou oferta de brinde, se ativado em <strong>Empresa</strong>).</p>
              <div id="agendaAniversariantesList" class="agenda-aniversariantes-list"></div>
            </div>
          </div>
        </div>
      </section>

      <section id="view-procedimento" class="view hidden">
        <div class="view-procedimento-header">
          <h2>Procedimentos e precifica√ß√£o</h2>
          <p class="view-lead" style="margin:0 0 0.75rem;">Cadastre servi√ßos e valores. Use o bloco de apoio √† precifica√ß√£o (IA) ao criar/editar; conecta agenda, estoque e finan√ßas.</p>
          <div class="view-procedimento-actions">
            <input type="file" id="importProcedimentosFile" accept=".csv,text/csv,application/csv" class="hidden" aria-label="Selecionar CSV">
            <label class="import-opcao-inline" title="Desmarque para importar todas; duplicados aparecer√£o como erro para revisar">
              <input type="checkbox" id="procedimentosPularDuplicados" checked> Pular duplicados
            </label>
            <button type="button" id="btnImportarProcedimentos" class="btn-secondary" title="Importar procedimentos (CSV)">üì• Importar CSV</button>
            <button type="button" id="btnNovoProcedimento" class="btn-primary">+ Novo procedimento</button>
          </div>
        </div>
        <div id="procedimentoCardMargemRisco" class="card-margem-risco hidden" aria-live="polite"></div>
        <div id="procedimentoFilters" class="procedimento-filters">
          <button type="button" id="procFiltersToggle" class="procedimento-filters__toggle" aria-expanded="false" aria-controls="procFiltersPanel">
            <span class="procedimento-filters__toggle-icon">‚ñæ</span>
            <span class="procedimento-filters__toggle-text">Filtros e ordena√ß√£o</span>
          </button>
          <div id="procFiltersPanel" class="procedimento-filters__panel" role="region" aria-label="Filtros" hidden>
            <div class="procedimento-filters__grid">
              <label class="procedimento-filters__label">Categoria <select id="procFilterCategory"><option value="">Todos</option></select></label>
              <span class="procedimento-filters__nova"><button type="button" id="btnNovaCategoria" class="procedimento-filters__link">+ Nova categoria</button></span>
              <label class="procedimento-filters__label">Status <select id="procFilterStatus"><option value="">Todos</option><option value="active">Ativos</option><option value="inactive">Inativos</option></select></label>
              <label class="procedimento-filters__label">Valor <select id="procFilterValor"><option value="">Todos</option><option value="with">Com valor</option><option value="without">Sem valor</option></select></label>
              <label class="procedimento-filters__label">Ordenar <select id="procFilterSort"><option value="name">Nome</option><option value="valor">Valor</option><option value="duration">Dura√ß√£o</option></select></label>
            </div>
          </div>
        </div>
        <div id="listaProcedimentos"></div>
        <div id="procedimentoPlanosWrap" class="procedimento-planos-wrap">
          <button type="button" id="procPlanosToggle" class="procedimento-planos__toggle" aria-expanded="false" aria-controls="procPlanosPanel">
            <span class="procedimento-planos__toggle-icon">‚ñæ</span>
            <span class="procedimento-planos__toggle-text">Planos baseados nesses procedimentos</span>
          </button>
          <div id="procPlanosPanel" class="procedimento-planos__panel" role="region" aria-label="Planos terap√™uticos" hidden>
            <p class="procedimento-planos__hint">Plano √© resposta √† dor do cliente, constru√≠da com procedimentos que fazem sentido para a cl√≠nica. N√£o √© pacote de venda.</p>
            <p class="procedimento-planos__hint procedimento-planos__hint-taxas" id="procPlanosHintTaxas">Para definir como cobrar o plano (parcelas, desconto √† vista) com margem garantida, configure as taxas em <strong>Configura√ß√µes ‚Üí Taxas da maquininha</strong>. Assim, ao precificar, voc√™ j√° sabe quanto recebe e qual desconto pode oferecer.</p>
            <button type="button" id="btnCriarPlanoTerapeutico" class="btn-primary">+ Criar plano</button>
            <div id="listaPlanosTerapeuticos" class="lista-planos-terapeuticos"></div>
          </div>
        </div>
        <div id="procedimentoDiscussaoWrap" class="procedimento-discussao-wrap">
          <button type="button" id="procDiscussaoToggle" class="procedimento-discussao__toggle" aria-expanded="false" aria-controls="procDiscussaoPanel">
            <span class="procedimento-discussao__toggle-icon">‚ñæ</span>
            <span class="procedimento-discussao__toggle-text">Discuss√£o de caso ‚Äî opini√£o da IA</span>
          </button>
          <div id="procDiscussaoPanel" class="procedimento-discussao__panel" role="region" aria-label="Discuss√£o de caso" hidden>
            <p class="procedimento-discussao__hint">Descreva o caso (queixa, condi√ß√£o, contexto) e pe√ßa a opini√£o da IA para <strong>amadurecer a ideia</strong> e se preparar. A IA traz discuss√£o do caso, procedimentos que podem se alinhar (para voc√™ avaliar) e <strong>artigos/refer√™ncias para voc√™ estudar</strong> ‚Äî incluindo links para diretrizes, PubMed ou Google Scholar quando fizer sentido. Objetivo: formar profissionais que sabem alinhar procedimentos a cada caso, n√£o encostar em protocolo pronto.</p>
            <label class="procedimento-discussao__label">Descreva o caso</label>
            <textarea id="discussaoCasoInput" class="procedimento-discussao__input" placeholder="Ex.: Paciente 35 anos, queixa de melasma em ma√ß√£s do rosto, j√° usou hidroquinona sem orienta√ß√£o. Fototipo III. Quer melhorar sem agredir a pele." rows="4"></textarea>
            <button type="button" id="btnPedirOpiniao" class="btn-primary">Pedir opini√£o da IA</button>
            <div id="discussaoCasoResult" class="procedimento-discussao__result" aria-live="polite" hidden></div>
          </div>
        </div>
        <div id="procedimentoRelatorioWrap" class="procedimento-relatorio-wrap">
          <button type="button" id="procRelatorioToggle" class="procedimento-relatorio__toggle" aria-expanded="false" aria-controls="procRelatorioPanel">
            <span class="procedimento-relatorio__toggle-icon">‚ñæ</span>
            <span class="procedimento-relatorio__toggle-text">Relat√≥rio: procedimentos realizados (per√≠odo)</span>
          </button>
          <div id="procRelatorioPanel" class="procedimento-relatorio__panel" role="region" aria-label="Relat√≥rio procedimentos realizados" hidden>
            <p class="procedimento-relatorio__hint">Quantidade de vezes que cada procedimento foi realizado na agenda no per√≠odo. Use para metas e an√°lise.</p>
            <div class="procedimento-relatorio__filtros">
              <label for="relatorioProcStartProc">De</label>
              <input type="date" id="relatorioProcStartProc" aria-label="Data inicial do relat√≥rio">
              <label for="relatorioProcEndProc">At√©</label>
              <input type="date" id="relatorioProcEndProc" aria-label="Data final do relat√≥rio">
              <label for="relatorioProcProfessionalProc">Profissional</label>
              <select id="relatorioProcProfessionalProc" aria-label="Filtrar por profissional"><option value="">Todos</option></select>
              <button type="button" id="btnAtualizarRelatorioProc" class="btn-primary">Atualizar</button>
              <button type="button" id="btnExportarRelatorioProc" class="btn-secondary">Exportar CSV</button>
            </div>
            <div id="relatorioProcedimentosRealizadosTable" class="procedimento-relatorio-table-wrap" aria-live="polite"></div>
          </div>
        </div>
      </section>

      <section id="view-financeiro" class="view hidden">
        <div class="view-financeiro-header">
          <h2>Financeiro</h2>
          <p class="view-lead view-financeiro-lead">Transa√ß√µes manuais (ex.: aluguel, sal√°rios). Vincule a procedimento para receita por servi√ßo; use contas/cart√µes ou importe extrato (CSV) para gastos. Use a aba <strong>Custo fixo</strong> para configurar aluguel, luz e outros custos recorrentes.</p>
          <div class="financeiro-main-tabs" role="tablist" aria-label="Abas do Financeiro">
            <button type="button" class="financeiro-main-tab is-active" data-tab="visao-geral" role="tab">Vis√£o geral</button>
            <button type="button" class="financeiro-main-tab" data-tab="custo-fixo" role="tab">Custo fixo</button>
          </div>
        </div>
        <div id="financeiroPanelVisaoGeral" class="financeiro-main-panel" role="tabpanel" data-tab="visao-geral">
          <div class="view-financeiro-actions">
            <button type="button" id="btnImportarExtrato" class="btn-secondary">üì• Importar extrato</button>
            <input type="file" id="importFinanceiroFile" accept=".csv,text/csv,application/csv" class="hidden" aria-label="Selecionar CSV">
            <button type="button" id="btnImportarPlanilha" class="btn-secondary" title="Importar planilha financeira (CSV)">üì• Importar CSV</button>
            <a href="#" id="btnModeloFinanceiro" class="btn-link" title="Baixar modelo CSV">Modelo CSV</a>
            <button type="button" id="btnPdf" class="btn-secondary">üìÑ Exportar PDF</button>
            <button type="button" id="btnNovaTransacao" class="btn-primary">+ Nova transa√ß√£o</button>
          </div>
          <div id="financeiroCardMargemRisco" class="card-margem-risco hidden" aria-live="polite"></div>
          <div id="financeiroContasVinculadasWrap" class="financeiro-contas-vinculadas-wrap">
            <div class="financeiro-contas-vinculadas-header">
              <h3 class="financeiro-contas-vinculadas-title">Contas e cart√µes vinculados (tempo real)</h3>
              <button type="button" id="btnVincularConta" class="btn-secondary">Vincular cart√£o ou conta</button>
            </div>
            <div id="listaContasVinculadas" class="lista-contas-vinculadas"></div>
          </div>
          <div id="financeiroImportacaoBanner" class="financeiro-importacao-banner hidden" role="status" aria-live="polite"></div>
          <div id="financeiroResumo" class="financeiro-resumo"></div>
          <div id="financeiroSaidasDetalhe" class="financeiro-saidas-detalhe"></div>
          <div id="financeiroPorProcedimento" class="financeiro-por-procedimento"></div>
          <h3 class="financeiro-list-title">Transa√ß√µes</h3>
          <div id="listaFinanceiro"></div>

          <div id="financeiroMasterWrap" class="financeiro-master-wrap hidden" aria-label="√Årea Master ‚Äî dados sens√≠veis">
          <h3 class="financeiro-master-title">√Årea Master (contas a pagar, fluxo, reserva, metas, participa√ß√£o)</h3>
          <p class="financeiro-master-hint">Estes dados s√£o vis√≠veis apenas para o master da organiza√ß√£o.</p>
          <div class="financeiro-master-tabs" role="tablist">
            <button type="button" class="financeiro-master-tab is-active" data-tab="contas" role="tab">Contas a pagar</button>
            <button type="button" class="financeiro-master-tab" data-tab="fluxo" role="tab">Fluxo de caixa</button>
            <button type="button" class="financeiro-master-tab" data-tab="reserva" role="tab">Reserva e metas</button>
            <button type="button" class="financeiro-master-tab" data-tab="participacao" role="tab">Participa√ß√£o nos lucros</button>
          </div>
          <div id="financeiroMasterContas" class="financeiro-master-panel" role="tabpanel" data-tab="contas">
            <div class="financeiro-master-panel-header">
              <h4>Contas a pagar</h4>
              <button type="button" id="btnNovaContaAPagar" class="btn-secondary">+ Nova conta</button>
            </div>
            <div id="listaContasAPagar" class="lista-contas-a-pagar"></div>
          </div>
          <div id="financeiroMasterFluxo" class="financeiro-master-panel hidden" role="tabpanel" data-tab="fluxo">
            <h4>Fluxo de caixa</h4>
            <div id="fluxoCaixaResumo" class="fluxo-caixa-resumo"></div>
          </div>
          <div id="financeiroMasterReserva" class="financeiro-master-panel hidden" role="tabpanel" data-tab="reserva">
            <div class="financeiro-master-panel-header">
              <h4>Reserva de emerg√™ncia e metas</h4>
              <button type="button" id="btnNovaMeta" class="btn-secondary">+ Nova meta</button>
            </div>
            <div id="listaFinanceiroMetas" class="lista-financeiro-metas"></div>
          </div>
          <div id="financeiroMasterParticipacao" class="financeiro-master-panel hidden" role="tabpanel" data-tab="participacao">
            <div class="financeiro-master-panel-header">
              <h4>Participa√ß√£o nos lucros (master e s√≥cios)</h4>
              <button type="button" id="btnNovaParticipacao" class="btn-secondary">+ Nova participa√ß√£o</button>
            </div>
            <div id="listaParticipacaoLucros" class="lista-participacao-lucros"></div>
          </div>
          </div>
        </div>
        <div id="financeiroCustoFixoPanel" class="financeiro-main-panel hidden" role="tabpanel" data-tab="custo-fixo" aria-label="Custo fixo ‚Äî organizar custos da cl√≠nica">
          <!-- Conte√∫do injetado por custo-fixo (ex-setup-inicial) -->
        </div>
      </section>

      <section id="view-precificacao-taxas" class="view hidden">
        <div class="view-header">
          <h2>Taxas da maquininha e simulador</h2>
          <p class="view-lead">Configure as taxas reais do banco. O sistema usa esses dados na precifica√ß√£o dos procedimentos e planos para mostrar margem real e sugerir como cobrar (parcelas, desconto √† vista).</p>
        </div>
        <div class="view-card precificacao-taxas-block">
          <h3 class="view-card-title">Suas taxas com o banco</h3>
          <p class="view-hint precificacao-taxas-hint">Informe o que a maquininha cobra; o simulador mostrar√° o valor l√≠quido.</p>
          <form id="precificacaoTaxasForm" class="precificacao-taxas-form">
            <div class="precificacao-taxas-grid">
              <div class="precificacao-taxas-group">
                <label for="precificacaoTaxaTransacao">Taxa de transa√ß√£o (%)</label>
                <input type="number" id="precificacaoTaxaTransacao" min="0" max="100" step="0.01" placeholder="Ex.: 0,50">
                <span class="precificacao-field-hint">Cobrada em toda transa√ß√£o, al√©m da taxa por forma de pagamento.</span>
              </div>
              <div class="precificacao-taxas-group">
                <label for="precificacaoTaxaAvistaDebito">√Ä vista ‚Äî D√©bito (%)</label>
                <input type="number" id="precificacaoTaxaAvistaDebito" min="0" max="100" step="0.01" placeholder="Ex.: 1,49">
              </div>
              <div class="precificacao-taxas-group">
                <label for="precificacaoTaxaAvistaCredito">√Ä vista ‚Äî Cr√©dito (%)</label>
                <input type="number" id="precificacaoTaxaAvistaCredito" min="0" max="100" step="0.01" placeholder="Ex.: 2,49">
              </div>
            </div>
            <p class="precificacao-parcelado-label">Taxa por parcela ‚Äî cada n√∫mero de vezes tem sua pr√≥pria taxa (%)</p>
            <div class="precificacao-parcelado-grid">
              <div class="precificacao-taxas-group" id="precificacaoParcelado2"><label for="precificacaoTaxa2">2x</label><input type="number" id="precificacaoTaxa2" min="0" max="100" step="0.01" placeholder="%"></div>
              <div class="precificacao-taxas-group" id="precificacaoParcelado3"><label for="precificacaoTaxa3">3x</label><input type="number" id="precificacaoTaxa3" min="0" max="100" step="0.01" placeholder="%"></div>
              <div class="precificacao-taxas-group" id="precificacaoParcelado4"><label for="precificacaoTaxa4">4x</label><input type="number" id="precificacaoTaxa4" min="0" max="100" step="0.01" placeholder="%"></div>
              <div class="precificacao-taxas-group" id="precificacaoParcelado5"><label for="precificacaoTaxa5">5x</label><input type="number" id="precificacaoTaxa5" min="0" max="100" step="0.01" placeholder="%"></div>
              <div class="precificacao-taxas-group" id="precificacaoParcelado6"><label for="precificacaoTaxa6">6x</label><input type="number" id="precificacaoTaxa6" min="0" max="100" step="0.01" placeholder="%"></div>
              <div class="precificacao-taxas-group" id="precificacaoParcelado7"><label for="precificacaoTaxa7">7x</label><input type="number" id="precificacaoTaxa7" min="0" max="100" step="0.01" placeholder="%"></div>
              <div class="precificacao-taxas-group" id="precificacaoParcelado8"><label for="precificacaoTaxa8">8x</label><input type="number" id="precificacaoTaxa8" min="0" max="100" step="0.01" placeholder="%"></div>
              <div class="precificacao-taxas-group" id="precificacaoParcelado9"><label for="precificacaoTaxa9">9x</label><input type="number" id="precificacaoTaxa9" min="0" max="100" step="0.01" placeholder="%"></div>
              <div class="precificacao-taxas-group" id="precificacaoParcelado10"><label for="precificacaoTaxa10">10x</label><input type="number" id="precificacaoTaxa10" min="0" max="100" step="0.01" placeholder="%"></div>
              <div class="precificacao-taxas-group" id="precificacaoParcelado11"><label for="precificacaoTaxa11">11x</label><input type="number" id="precificacaoTaxa11" min="0" max="100" step="0.01" placeholder="%"></div>
              <div class="precificacao-taxas-group" id="precificacaoParcelado12"><label for="precificacaoTaxa12">12x</label><input type="number" id="precificacaoTaxa12" min="0" max="100" step="0.01" placeholder="%"></div>
            </div>
            <button type="submit" id="precificacaoBtnSalvarTaxas" class="btn-primary">Salvar taxas</button>
          </form>
        </div>
        <div class="view-card precificacao-simulador-block">
          <h3 class="view-card-title">Simulador: quanto voc√™ recebe</h3>
          <label for="precificacaoValorProcedimento">Valor do procedimento ou plano (R$)</label>
          <p class="view-hint precificacao-simulador-hint">Digite o valor para ver o l√≠quido por forma de pagamento e qual desconto √† vista faz sentido.</p>
          <input type="text" id="precificacaoValorProcedimento" inputmode="decimal" placeholder="Ex.: 500,00 ou 2.100,00" class="precificacao-input-valor">
          <div id="precificacaoTabelaSimulador" class="precificacao-tabela-wrap" aria-live="polite"></div>
        </div>
        <div id="precificacaoBlocoDescontoAvista" class="precificacao-desconto-avista hidden" aria-live="polite">
          <h3>Desconto √† vista</h3>
          <p class="precificacao-desconto-text"></p>
        </div>
        <div id="precificacaoRecomendacao" class="precificacao-recomendacao hidden" aria-live="polite">
          <h3>Recomenda√ß√£o</h3>
          <p class="precificacao-recomendacao-text"></p>
        </div>
      </section>

      <section id="view-auditoria" class="view hidden">
        <div class="view-logs-header">
          <h2>Auditoria</h2>
          <div class="view-logs-toolbar">
            <label class="logs-filter-wrap" for="logsFilterPeriod">
              <span>Per√≠odo:</span>
              <select id="logsFilterPeriod" class="logs-filter" title="√öltimos 7 ou 30 dias" aria-label="Filtrar por per√≠odo">
                <option value="all">Todo o per√≠odo</option>
                <option value="7">√öltimos 7 dias</option>
                <option value="30">√öltimos 30 dias</option>
              </select>
            </label>
            <label class="logs-filter-wrap" for="logsFilterType">
              <span>Tipo:</span>
              <select id="logsFilterType" class="logs-filter" title="Filtrar por √°rea (financeiro, clientes, procedimentos‚Ä¶)" aria-label="Filtrar por tipo de a√ß√£o">
                <option value="all">Todos</option>
                <option value="financeiro">Financeiro</option>
                <option value="cliente">Clientes / Edi√ß√£o</option>
                <option value="procedimento">Procedimentos</option>
                <option value="agenda">Agenda</option>
                <option value="equipe">Equipe</option>
                <option value="estoque">Estoque</option>
                <option value="outros">Outros</option>
              </select>
            </label>
            <label class="logs-filter-wrap" for="logsFilterAck">
              <span>Status:</span>
              <select id="logsFilterAck" class="logs-filter" title="Pendentes = itens que o gestor ainda n√£o deu ok" aria-label="Filtrar por status">
                <option value="all">Todos</option>
                <option value="pending">Pendentes (sem ok do gestor)</option>
              </select>
            </label>
            <button type="button" id="btnExportarAuditoriaCsv" class="btn-secondary btn-sm" title="Exportar logs filtrados em CSV">Exportar CSV</button>
          </div>
        </div>
        <p class="view-lead">Registro de a√ß√µes da equipe. Filtre por per√≠odo, tipo ou itens pendentes de ok do gestor.</p>
        <div id="listaLogs" class="logs-list"></div>
        <div id="logsLoadMoreWrap" class="logs-load-more-wrap hidden">
          <button type="button" id="btnLogsLoadMore" class="btn-secondary">Carregar mais</button>
        </div>
      </section>

      <section id="view-backup" class="view hidden">
        <div class="view-header">
          <h2>Backup</h2>
          <p class="view-lead">C√≥pia de seguran√ßa em JSON (clientes, procedimentos, financeiro, agenda). Para exportar/importar por tipo (CSV), use <a href="#" data-view="export">Exportar e importar</a> no menu.</p>
        </div>
        <div class="backup-blocks">
          <div class="view-card backup-block">
            <h3 class="view-card-title">Baixar backup</h3>
            <p class="view-hint backup-block-hint">Gera um arquivo com todos os dados atuais.</p>
            <button type="button" id="btnBackup" class="btn-primary">Baixar backup</button>
          </div>
          <div class="view-card backup-block">
            <h3 class="view-card-title">Restaurar backup</h3>
            <p class="view-hint backup-block-hint">Escolha um arquivo gerado por este sistema; os dados ser√£o importados na organiza√ß√£o atual.</p>
            <input type="file" id="backupRestoreFile" accept=".json,application/json" class="hidden" aria-label="Arquivo de backup">
            <button type="button" id="btnRestore" class="btn-primary">Escolher arquivo e restaurar</button>
            <div id="backupRestoreResult" class="backup-result hidden"></div>
          </div>
        </div>
      </section>

      <section id="view-documentos-termos" class="view hidden">
        <div class="view-header">
          <h2>Documentos e termos</h2>
          <p class="view-lead">Contrato de presta√ß√£o de servi√ßos, termo de consentimento informado, autoriza√ß√£o de imagem, orienta√ß√µes p√≥s-procedimento, LGPD e pol√≠tica de cancelamento. Essencial para defesa judicial. Use os modelos como base e revise com advogado especializado antes de produ√ß√£o.</p>
        </div>
        <div class="view-card documentos-termos-aviso">
          <p class="view-hint"><span class="info-icon" title="Os modelos s√£o ponto de partida. A legisla√ß√£o varia por localidade." aria-label="Informa√ß√£o">‚ÑπÔ∏è</span> Estes s√£o <strong>modelos profissionais</strong> para respaldo at√© voc√™ contratar um advogado especializado. Devem ser revisados e adaptados por profissional em direito civil, contratos e direito da sa√∫de/est√©tica. A <strong>Anamnese</strong> (item 7) √© a ficha cl√≠nica ‚Äî use o menu Anamnese no app.</p>
        </div>
        <div id="documentosTermosLista" class="documentos-termos-lista"></div>
      </section>

      <section id="view-copiloto" class="view hidden">
        <div class="view-header">
          <h2>Copiloto do Neg√≥cio</h2>
          <p class="view-lead">Pergunte sobre dados e indicadores da cl√≠nica; a IA responde com base no que est√° no sistema.</p>
        </div>
        <div class="view-card">
          <div class="view-field">
            <label for="pergunta">Sua pergunta</label>
            <textarea id="pergunta" placeholder="Ex.: Qual foi o faturamento dos √∫ltimos 30 dias?" rows="3"></textarea>
          </div>
          <button type="button" id="btnPerguntar" class="btn-primary">Perguntar</button>
        </div>
        <pre id="resposta"></pre>
      </section>

      <section id="view-marketing" class="view hidden">
        <div class="view-header">
          <h2>Copilot de Marketing</h2>
          <p class="view-lead">Sugest√µes de conte√∫do, foco e m√©tricas com base nos dados da cl√≠nica. Cidade e procedimentos v√™m do cadastro da empresa e do cat√°logo; voc√™ pode editar.</p>
        </div>
        <div class="view-card">
          <div class="view-field">
            <label for="nicho">Nicho</label>
            <input id="nicho" placeholder="Ex.: est√©tica facial, dermatologia">
          </div>
          <div class="view-field">
            <label for="cidade">Cidade / regi√£o</label>
            <input id="cidade" placeholder="Ex.: S√£o Paulo">
          </div>
          <div class="view-field">
            <label for="ticket">Faixa de ticket (contexto)</label>
            <input id="ticket" placeholder="Ex.: R$ 200‚Äì800">
          </div>
          <div class="view-field">
            <label for="procedimentos">Procedimentos principais</label>
            <textarea id="procedimentos" placeholder="Preenchido pelo cat√°logo; edite se quiser" rows="3"></textarea>
          </div>
          <button type="button" id="btnGerarMarketing" class="btn-primary">Sugerir conte√∫do e m√©tricas</button>
        </div>
        <p class="view-hint marketing-metricas-hint">A resposta inclui m√©tricas de tr√°fego pago (CPL, CPA, ROAS): o que s√£o e como aplicar. Leia o item 3 da resposta para interpretar.</p>
        <pre id="resultadoMarketing"></pre>
        <button type="button" id="btnMarketingParaCalendario" class="btn-secondary" style="margin-top:0.5rem;">Adicionar sugest√£o ao calend√°rio</button>
      </section>

      <section id="view-calendario-conteudo" class="view hidden">
        <div class="view-header">
          <h2>Calend√°rio de conte√∫do</h2>
          <p class="view-lead">Rascunho ‚Üí aprova√ß√£o ‚Üí agendamento ‚Üí publica√ß√£o. Use as sugest√µes do <a href="#" data-view="marketing">Marketing</a> ou crie posts manualmente.</p>
        </div>
        <div class="view-card">
          <h3 class="view-card-title">Conte√∫dos</h3>
          <div class="view-calendario-conteudo-actions">
            <button type="button" id="calendarioConteudoBtnNovo" class="btn-primary">+ Novo conte√∫do</button>
            <label for="calendarioConteudoFiltro">Status</label>
            <select id="calendarioConteudoFiltro">
              <option value="">Todos</option>
              <option value="rascunho">Rascunho</option>
              <option value="em_aprovacao">Em aprova√ß√£o</option>
              <option value="aprovado">Aprovado</option>
              <option value="rejeitado">Rejeitado</option>
              <option value="agendado">Agendado</option>
              <option value="publicado">Publicado</option>
            </select>
          </div>
          <div id="listaCalendarioConteudo" class="lista-calendario-conteudo"></div>
        </div>
      </section>

      <section id="view-estoque" class="view hidden">
        <div class="view-header">
          <h2>Estoque</h2>
          <p class="view-lead">Entrada por nota fiscal ou manual; consumo estimado por protocolo e indicador de acur√°cia (previsto vs real).</p>
        </div>
        <div class="view-card">
          <div class="estoque-entrada-actions">
            <button type="button" id="btnEstoqueEntradaOCR" class="btn-primary">üì∑ Ler nota fiscal</button>
            <button type="button" id="btnEstoqueImportarNota" class="btn-secondary" disabled title="Em breve">üìÑ Importar nota (XML)</button>
            <button type="button" id="btnEstoqueEntradaManual" class="btn-secondary">‚úèÔ∏è Entrada manual</button>
          </div>
        </div>
        <div class="view-card estoque-acuracia-wrap" id="estoqueAcuraciaWrap">
          <h3 class="view-card-title">Indicador de acur√°cia (previsto vs real)</h3>
          <p class="view-hint estoque-acuracia-hint">Compare consumo previsto (protocolo) com o real que voc√™ registrar. Meta sugerida: 85%.</p>
          <div class="estoque-acuracia-periodo">
            <label for="estoqueAcuraciaPeriodo">Per√≠odo</label>
            <select id="estoqueAcuraciaPeriodo">
              <option value="7">√öltimos 7 dias</option>
              <option value="30" selected>√öltimos 30 dias</option>
              <option value="90">√öltimos 90 dias</option>
            </select>
            <button type="button" id="btnEstoqueRegistrarReal" class="btn-secondary">Registrar consumo real</button>
          </div>
          <div id="estoqueAcuraciaCard" class="estoque-acuracia-card"></div>
          <div id="estoqueAcuraciaTabela" class="estoque-acuracia-tabela"></div>
        </div>
        <div class="view-card estoque-resumo-wrap" id="estoqueResumoWrap">
          <h3 class="view-card-title">Resumo por produto</h3>
          <div id="estoqueResumo" class="estoque-resumo"></div>
        </div>
        <div class="view-card">
          <h3 class="view-card-title">√öltimas entradas</h3>
          <div id="listaEstoqueEntradas" class="lista-estoque-entradas"></div>
          <p id="estoqueEmpty" class="estoque-empty hidden">Nenhuma entrada ainda. Use Ler nota fiscal ou entrada manual.</p>
        </div>
        <div class="view-card estoque-analise-wrap">
          <button type="button" id="btnAnalisarEstoque" class="btn-secondary">Analisar estoque (sugest√µes IA)</button>
          <pre id="resultadoEstoque" class="estoque-resultado hidden"></pre>
        </div>
      </section>

      <section id="view-ocr" class="view hidden">
        <div class="view-header">
          <h2>Notas fiscais</h2>
          <p class="view-lead">Emiss√£o de nota fiscal de servi√ßo (NFS-e). Para dar entrada no estoque a partir de nota de compra, use <a href="#" data-view="estoque">Estoque</a> ‚Üí Ler nota fiscal.</p>
        </div>
        <div class="view-card ocr-emitir-card">
          <h3 class="view-card-title">Emitir nota fiscal</h3>
          <p class="view-hint">Emita NFS-e ou NF-e a partir dos atendimentos e receitas. Use o link do sistema da prefeitura ou do seu contador; em breve: integra√ß√£o direta aqui.</p>
          <a id="ocrEmitirLink" href="#" target="_blank" rel="noopener noreferrer" class="btn-primary ocr-emitir-btn hidden">Abrir sistema de emiss√£o</a>
          <p id="ocrEmitirPlaceholder" class="ocr-emitir-placeholder">Configure em <a href="#" data-view="empresa">Empresa</a> (Configura√ß√µes) o link do sistema de emiss√£o da sua prefeitura ou contador para o bot√£o aparecer aqui.</p>
        </div>
      </section>

      <section id="view-skincare" class="view hidden">
        <div class="view-header">
          <h2>Skincare IA</h2>
          <p class="view-lead">Carregue o contexto do cliente, preencha uma ficha r√°pida ou tire fotos em cabine; depois use os campos abaixo e gere a rotina.</p>
        </div>
        <div class="view-card">
        <div class="skincare-ia-actions">
          <button type="button" id="btnSkincarePesquisarCliente" class="btn-secondary">Pesquisar cliente</button>
          <button type="button" id="btnSkincareFichaRapida" class="btn-secondary">Ficha r√°pida (para a IA)</button>
          <button type="button" id="btnSkincareFotosCabine" class="btn-secondary">Tirar fotos em cabine</button>
        </div>
        <div id="skincareFotosCabineWrap" class="skincare-fotos-cabine-wrap hidden">
          <div class="skincare-fotos-cabine-buttons">
            <input type="file" id="skincareFotosCabineInput" accept="image/*" multiple class="hidden">
            <button type="button" id="btnSkincareFotosEscolher" class="btn-secondary">Escolher fotos</button>
            <button type="button" id="btnSkincareFotosCamera" class="btn-secondary">Usar c√¢mera</button>
          </div>
          <div id="skincareFotosCabineCamera" class="skincare-camera-area hidden">
            <video id="skincareCameraVideo" class="skincare-camera-video" autoplay playsinline muted></video>
            <button type="button" id="btnSkincareCapturar" class="btn-primary">Capturar foto</button>
          </div>
          <div id="skincareFotosPreview" class="skincare-fotos-preview"></div>
        </div>
        <div id="skincareContextoLabel" class="skincare-ia-contexto-badge hidden" aria-live="polite"></div>
        <div class="skincare-ia-form">
          <div class="skincare-ia-field-block">
            <label for="skincareAnalise" class="skincare-ia-label">An√°lise / contexto (opcional)</label>
            <textarea id="skincareAnalise" class="skincare-ia-textarea" rows="6" placeholder="Texto ou JSON da an√°lise de pele ou contexto do cliente"></textarea>
          </div>
          <div class="skincare-ia-field-block">
            <label for="skincareProtocolo" class="skincare-ia-label">Protocolo (opcional)</label>
            <textarea id="skincareProtocolo" class="skincare-ia-textarea skincare-ia-textarea--short" rows="3" placeholder="Texto ou JSON do protocolo atual"></textarea>
          </div>
          <button type="button" id="btnGerarSkincare" class="btn-primary">Gerar rotina</button>
        </div>
        <pre id="resultadoSkincare" class="skincare-ia-resultado"></pre>
        <div id="skincareSalvarWrap" class="skincare-salvar-wrap hidden">
          <p class="skincare-salvar-hint">Revise o texto acima e, se estiver ok, salve no perfil do cliente. Depois voc√™ pode editar na aba Rotina skincare do cliente e liberar no portal.</p>
          <button type="button" id="btnSkincareSalvarCliente" class="btn-primary">Salvar no perfil do cliente</button>
        </div>
        </div>
      </section>

      <section id="view-estudo-caso" class="view hidden">
        <div class="view-header">
          <h2>Estudo de caso</h2>
          <p class="view-lead">Casos anonimizados ligados ao protocolo (m√©todo + hist√≥rico). Fa√ßa <strong>perguntas pertinentes</strong> para obter um melhor resultado e, ap√≥s ler os artigos sugeridos, <strong>esclare√ßa d√∫vidas</strong> para aprender de verdade.</p>
        </div>
        <div class="view-card">
        <label>Protocolo</label>
        <select id="estudoCasoProtocolo">
          <option value="">‚Äî Selecione o protocolo ‚Äî</option>
        </select>
        <div id="estudoCasoAgregacao" class="estudo-caso-agregacao hidden"></div>
        <div id="estudoCasoLista" class="estudo-caso-lista"></div>
        <div class="estudo-caso-novo">
          <h3>Registrar novo caso (anonimizado)</h3>
          <p class="estudo-caso-form-hint">Tipo de pele e fototipo s√£o diferentes: tipo = oleosa/mista/seca; fototipo = Fitzpatrick (rea√ß√£o ao sol). Protocolo = procedimento aplicado; an√°lise de pele = avalia√ß√£o/contexto.</p>
          <div class="estudo-caso-form-row">
            <div class="estudo-caso-form-field">
              <label for="estudoCasoTipoPele">Tipo de pele</label>
              <select id="estudoCasoTipoPele">
                <option value="">‚Äî Opcional ‚Äî</option>
                <option value="oleosa">Oleosa</option>
                <option value="mista">Mista</option>
                <option value="seca">Seca</option>
                <option value="normal">Normal</option>
                <option value="sensivel">Sens√≠vel</option>
                <option value="outro">Outro</option>
              </select>
            </div>
            <div class="estudo-caso-form-field">
              <label for="estudoCasoFototipo">Fototipo (Fitzpatrick)</label>
              <select id="estudoCasoFototipo">
                <option value="">‚Äî Opcional ‚Äî</option>
                <option value="I">I</option>
                <option value="II">II</option>
                <option value="III">III</option>
                <option value="IV">IV</option>
                <option value="V">V</option>
                <option value="VI">VI</option>
              </select>
            </div>
          </div>
          <label for="estudoCasoQueixa">Queixa principal</label>
          <input type="text" id="estudoCasoQueixa" placeholder="Ex.: melasma, acne grau II">
          <label for="estudoCasoAnalisePele">An√°lise de pele (resumo, opcional)</label>
          <textarea id="estudoCasoAnalisePele" rows="2" placeholder="Resumo da avalia√ß√£o da pele (diferente do protocolo aplicado)"></textarea>
          <label for="estudoCasoResposta">Resposta observada</label>
          <select id="estudoCasoResposta">
            <option value="">‚Äî Selecione ‚Äî</option>
            <option value="melhora">Melhora</option>
            <option value="sem_mudanca">Sem mudan√ßa</option>
            <option value="efeito_adverso">Efeito adverso</option>
          </select>
          <label for="estudoCasoNSessoes">N¬∫ de sess√µes (opcional)</label>
          <input type="number" id="estudoCasoNSessoes" min="1" placeholder="Ex.: 6">
          <label for="estudoCasoObservacao">Observa√ß√£o (opcional)</label>
          <textarea id="estudoCasoObservacao" rows="2" placeholder="Detalhes que ajudem o estudo"></textarea>
          <button type="button" id="estudoCasoBtnRegistrar" class="btn-primary">Registrar caso</button>
        </div>
        <div class="estudo-caso-esclarecer-global">
          <h3>Esclarecer d√∫vida ap√≥s leitura</h3>
          <p class="estudo-caso-esclarecer-hint">Leu um artigo e ficou com d√∫vida? Descreva o tema ou o que leu e a sua d√∫vida; a IA ajuda a esclarecer para voc√™ aprender de verdade.</p>
          <label>Tema ou artigo que voc√™ leu (opcional)</label>
          <textarea id="estudoCasoEsclarecerTema" rows="2" placeholder="Ex.: guideline de melasma, artigo sobre √°cido retin√≥ico"></textarea>
          <label>Sua d√∫vida</label>
          <textarea id="estudoCasoEsclarecerDuvida" rows="3" placeholder="Ex.: N√£o entendi a diferen√ßa entre X e Y..."></textarea>
          <button type="button" id="estudoCasoBtnEsclarecer" class="btn-primary">Esclarecer d√∫vida</button>
          <pre id="estudoCasoEsclarecerResultado" class="estudo-caso-resultado hidden"></pre>
        </div>
        </div>
      </section>

      <section id="view-protocolo" class="view hidden">
        <div class="view-header">
          <h2 class="protocolo-ia-title">Protocolo IA <span class="info-icon" title="Use os campos abaixo ou o resultado da An√°lise de Pele (view Pele) como entrada. Idade e fototipo melhoram a sugest√£o." aria-label="Informa√ß√£o">‚ÑπÔ∏è</span></h2>
        </div>
        <div class="view-card">
        <div class="protocolo-ia-form">
          <label for="protocoloAnalise" class="protocolo-ia-label">An√°lise <span class="info-icon" title="Cole o resultado da view An√°lise de Pele (JSON) ou descreva o caso em texto livre." aria-label="Informa√ß√£o">‚ÑπÔ∏è</span></label>
          <textarea id="protocoloAnalise" class="protocolo-ia-textarea" rows="5" placeholder="Resultado da An√°lise de Pele (JSON) ou descri√ß√£o do caso"></textarea>
          <div class="protocolo-ia-row">
            <div class="protocolo-ia-field">
              <label for="protocoloIdade">Idade</label>
              <input type="text" id="protocoloIdade" placeholder="Ex.: 35">
            </div>
            <div class="protocolo-ia-field">
              <label for="protocoloFototipo">Fototipo</label>
              <input type="text" id="protocoloFototipo" placeholder="Ex.: III">
            </div>
          </div>
          <button type="button" id="btnGerarProtocolo" class="btn-primary">Gerar protocolo</button>
        </div>
        <pre id="resultadoProtocolo" class="protocolo-ia-resultado"></pre>
        </div>
      </section>

      <section id="view-anamnese" class="view hidden">
        <div class="view-header">
          <h2>Ficha de Anamnese</h2>
          <p class="view-lead">Ficha por √°rea/queixa (cabelo, rosto ‚Äî pele ou injet√°veis ‚Äî, corpo). Abra pelo perfil do cliente ou pela Agenda, ou escolha o cliente abaixo. <strong>Registro completo</strong> (ficha) ou s√≥ <strong>evolu√ß√£o</strong> (fotos e coment√°rio).</p>
        </div>
        <div class="view-card">
        <div class="anamnese-cliente-select-wrap">
          <label for="anamneseClienteSelect">Cliente</label>
          <select id="anamneseClienteSelect" class="anamnese-cliente-select">
            <option value="">‚Äî Selecione o cliente ‚Äî</option>
          </select>
        </div>
        <div id="anamneseContext" class="anamnese-context hidden"></div>
        <div id="anamneseFormWrap" class="anamnese-form-wrap hidden">
          <label>Tipo de registro</label>
          <select id="anamneseTipoRegistro">
            <option value="completo">Ficha completa (primeira vez ou reassessment)</option>
            <option value="evolucao">S√≥ evolu√ß√£o (fotos e coment√°rio desta sess√£o)</option>
          </select>
          <label>√Årea / Queixa</label>
          <select id="anamneseFuncao"></select>
          <div id="anamneseFichaCamposWrap" class="anamnese-ficha-wrap">
            <div id="anamneseFichaCampos" class="anamnese-ficha-campos"></div>
          </div>
          <label>Observa√ß√µes gerais</label>
          <textarea id="anamneseConteudo" placeholder="Observa√ß√µes livres deste atendimento‚Ä¶" rows="3"></textarea>
          <label>Fotos</label>
          <input type="file" id="anamneseFotos" accept="image/*" multiple>
          <div id="anamneseFotosPreview" class="anamnese-fotos-preview"></div>
          <label>Conduta do tratamento</label>
          <textarea id="anamneseConduta" placeholder="Plano, pr√≥ximos passos, como conduzir o tratamento‚Ä¶" rows="3"></textarea>
          <button type="button" id="btnAnamneseSalvar">Salvar ficha</button>
        </div>
        <div id="anamneseSemCliente" class="anamnese-sem-cliente hidden">
          <p>Selecione um cliente no campo acima para acessar a ficha e o hist√≥rico.</p>
        </div>
        <div id="anamneseHistorio" class="anamnese-historio">
          <h3>Hist√≥rico (evolutivo)</h3>
          <div id="anamneseRegistros"></div>
          <div id="anamneseCompareWrap" class="anamnese-compare-wrap hidden"></div>
        </div>
        </div>
      </section>

      <section id="view-analise-pele" class="view hidden">
        <div class="view-header">
          <h2>An√°lises de pele</h2>
          <p class="view-lead">An√°lises enviadas pelo portal do cliente. Valide e incorpore √† Anamnese (Pele) quando fizer sentido.</p>
        </div>
        <div id="analisePeleLista" class="view-card"></div>
        <div id="analisePeleDetalhe" class="analise-pele-detalhe-wrap hidden" aria-live="polite"></div>
      </section>

      <section id="view-pele" class="view hidden">
        <h2>An√°lise de Pele</h2>
        <input type="file" id="fotos" multiple>
        <input id="idade" placeholder="Idade">
        <input id="fototipo" placeholder="Fototipo">
        <textarea id="queixa" placeholder="Queixa"></textarea>
        <button type="button" id="btnAnalisar">Analisar</button>
        <pre id="resultado"></pre>
      </section>

      <section id="view-notificacoes" class="view hidden">
        <div class="view-header">
          <h2>Notifica√ß√µes</h2>
          <p class="view-lead">Se apareceu um n√∫mero no sino (canto superior direito), vale a pena clicar. Aqui voc√™ v√™ todas e pode marcar como lida ou limpar.</p>
        </div>
        <div class="view-card">
          <div id="listaNotificacoes"></div>
        </div>
      </section>

      <section id="view-para-clinicas" class="view hidden">
        <div class="view-header">
          <h2>Central de ajuda</h2>
          <p class="view-lead">D√∫vidas frequentes, atalhos para as telas e como usar o sistema no dia a dia. Use o tutorial para um passo a passo guiado.</p>
        </div>
        <div class="view-card">
          <p class="para-clinicas-tutorial-wrap">
            <button type="button" id="btnTutorialRecomecar" class="btn-secondary">üìñ Iniciar ou refazer o tutorial</button>
            <span class="para-clinicas-tutorial-hint">Passo a passo para conhecer o app; tamb√©m no menu lateral.</span>
          </p>
          <p class="para-clinicas-suporte">Precisa de suporte? Entre em contato pelo e-mail ou canal indicado no seu contrato. Para d√∫vidas de uso, consulte a FAQ abaixo e os atalhos para cada tela.</p>
        </div>
        <div class="view-card">
          <h3 class="view-card-title">Perguntas frequentes</h3>
          <div class="para-clinicas-faq" id="paraClinicasFaq">
          <details class="para-clinicas-details">
            <summary>Por que precifica√ß√£o com taxas da maquininha?</summary>
            <p>O sistema usa as <strong>taxas reais</strong> que o banco cobra (√† vista, parcelado 2‚Äì6x, 7‚Äì12x) para calcular quanto voc√™ <strong>realmente recebe</strong> em cada forma de pagamento. Assim voc√™ v√™ a <strong>margem real</strong> por procedimento e por plano, e define descontos ou parcelas sem perder lucro. O simulador e a precifica√ß√£o dos procedimentos usam esses dados.</p>
            <p><a href="#" data-view="precificacao-taxas">Ir para Configura√ß√µes ‚Üí Taxas da maquininha</a></p>
          </details>
          <details class="para-clinicas-details">
            <summary>O que √© protocolo aplicado? E a diferen√ßa para plano?</summary>
            <p><strong>Plano</strong> √© a proposta comercial (dor do cliente + valor cobrado, ex.: pacote de sess√µes). <strong>Protocolo</strong> √© o m√©todo: quais passos, quais produtos, quanto de cada um. O SkinClinic valoriza o <strong>registro do que foi aplicado</strong>: ao marcar ‚Äúprotocolo aplicado‚Äù no atendimento, o sistema registra consumo de estoque e mant√©m hist√≥rico. Isso gera rastreabilidade e alimenta o indicador de acur√°cia de estoque (previsto vs real).</p>
            <p><a href="#" data-view="protocolo">Ir para Protocolo</a></p>
          </details>
          <details class="para-clinicas-details">
            <summary>Como usar planos e margem sem perder lucro?</summary>
            <p>Cadastre os procedimentos com custo e margem desejada. Ao montar um <strong>plano terap√™utico</strong> (v√°rios procedimentos + quantidades), o sistema mostra o valor sugerido do plano. Use o bot√£o <strong>Simular recebimento</strong> para ver quanto voc√™ recebe √† vista, em 6x ou 12x, e qual desconto pode oferecer. Configure as taxas em <strong>Configura√ß√µes ‚Üí Taxas da maquininha</strong> para que os n√∫meros reflitam a realidade.</p>
            <p><a href="#" data-view="procedimento">Ir para Procedimentos</a> ¬∑ <a href="#" data-view="precificacao-taxas">Taxas da maquininha</a></p>
          </details>
          <details class="para-clinicas-details">
            <summary>Onde ver fotos e evolu√ß√£o do cliente (antes/depois)?</summary>
            <p>No <strong>perfil do cliente</strong>, aba <strong>Hist√≥rico / Linha do tempo</strong>, h√° a se√ß√£o <strong>Fotos antes/depois</strong>: adicione fotos por data e tipo (antes ou depois), opcionalmente vinculadas a um procedimento. Tamb√©m h√° o resumo da evolu√ß√£o por √°rea (anamnese) e, na <strong>Ficha de Anamnese</strong>, o <strong>Comparar</strong> para ver dois registros lado a lado e gerar relat√≥rio.</p>
            <p><a href="#" data-view="clientes">Clientes</a> ¬∑ <a href="#" data-view="anamnese">Anamnese</a></p>
          </details>
          <details class="para-clinicas-details">
            <summary>Lembrete de agendamento e mensagem de anivers√°rio</summary>
            <p>Na <strong>Agenda</strong>, cada agendamento tem: <strong>‚úâÔ∏è E-mail</strong> (abre seu programa de e-mail com mensagem personalizada ‚Äî custo zero), <strong>üìã Lembrete</strong> (copia o texto com link de confirma√ß√£o) e <strong>üì≤ WhatsApp</strong>. Use E-mail quando o cliente tiver e-mail cadastrado. Abaixo da lista do dia, o bloco <strong>Aniversariantes</strong> mostra aniversariantes da semana; use <strong>Enviar mensagem</strong> para parab√©ns. Em <strong>Empresa</strong> voc√™ pode habilitar oferta de brinde de anivers√°rio.</p>
            <p><a href="#" data-view="agenda">Ir para Agenda</a> ¬∑ <a href="#" data-view="empresa">Empresa</a></p>
          </details>
          <details class="para-clinicas-details">
            <summary>O que √© o indicador de acur√°cia de estoque?</summary>
            <p>Compara <strong>consumo previsto</strong> (o que o protocolo indica que seria usado) com o <strong>consumo real</strong> que voc√™ registra (ex.: ap√≥s contagem). A meta sugerida √© ~85%: quanto mais pr√≥ximo, melhor a previs√£o. Em <strong>Estoque</strong>, o bloco ‚ÄúIndicador de acur√°cia‚Äù mostra o per√≠odo, os totais e a tabela por produto. Use <strong>Registrar consumo real</strong> para informar o que foi realmente consumido.</p>
            <p><a href="#" data-view="estoque">Ir para Estoque</a></p>
          </details>
          <details class="para-clinicas-details">
            <summary>O sistema sugere pre√ßo ou desconto sozinho?</summary>
            <p>N√£o. A <strong>IA sugere</strong> (valor de procedimento, textos de marketing, estudo de caso, etc.), mas <strong>quem decide √© a cl√≠nica</strong>. O financeiro n√£o aplica descontos autom√°ticos; o simulador de taxas mostra cen√°rios para voc√™ escolher. No portal do cliente, resultados de an√°lise de pele ou rotina passam por <strong>valida√ß√£o</strong> antes do cliente ver ‚Äî refor√ßando que a decis√£o cl√≠nica fica com voc√™.</p>
          </details>
          <details class="para-clinicas-details">
            <summary>Onde ficam os termos, contratos e documenta√ß√£o jur√≠dica?</summary>
            <p>Em <strong>Configura√ß√µes ‚Üí Documentos e termos</strong> voc√™ gerencia: pol√≠tica de privacidade, termo de tratamento de dados (LGPD), pol√≠tica de cancelamento e remarca√ß√£o, contrato de presta√ß√£o de servi√ßos e termo de consentimento completo. Essencial para defesa judicial. Os modelos devem ser revisados por advogado. O termo por cliente √© no perfil do cliente; cada procedimento pode ter cl√°usula espec√≠fica em Procedimentos.</p>
            <p><a href="#" data-view="documentos-termos">Ir para Documentos e termos</a> ¬∑ <a href="#" data-view="clientes">Clientes (termo por cliente)</a></p>
          </details>
          <details class="para-clinicas-details">
            <summary>Como obter suporte?</summary>
            <p>Entre em contato pelo e-mail ou canal indicado no seu contrato ou no momento da assinatura. Para d√∫vidas de uso do sistema, use esta <strong>Central de ajuda</strong> (FAQ e atalhos acima) e o <strong>tutorial</strong> para conhecer o passo a passo. Em <strong>Configura√ß√µes</strong> voc√™ encontra backup, auditoria, <a href="#" data-view="documentos-termos">documentos e termos</a> e dados da empresa.</p>
          </details>
          </div>
        </div>
      </section>

      <section id="view-master" class="view hidden">
        <div class="view-header">
          <h2>Configura√ß√µes</h2>
          <p class="view-lead">Informa√ß√µes e configura√ß√µes importantes da organiza√ß√£o. Dados da empresa e planos de assinatura ficam aqui.</p>
        </div>
        <div class="master-settings-grid">
          <div class="master-settings-card" data-view="para-clinicas">
            <span class="master-settings-icon">‚ùì</span>
            <h3>Central de ajuda</h3>
            <p>FAQ, atalhos para as telas e tutorial. D√∫vidas de uso e como obter suporte.</p>
            <button type="button" class="btn-secondary master-card-btn">Abrir</button>
          </div>
          <div class="master-settings-card" data-view="empresa">
            <span class="master-settings-icon">üè¢</span>
            <h3>Dados da empresa</h3>
            <p>Nome, endere√ßo, CNPJ, logo e salas da cl√≠nica.</p>
            <button type="button" class="btn-secondary master-card-btn">Abrir</button>
          </div>
          <div class="master-settings-card" data-view="planos">
            <span class="master-settings-icon">üí≥</span>
            <h3>Planos</h3>
            <p>Assinatura e planos da organiza√ß√£o.</p>
            <button type="button" class="btn-secondary master-card-btn">Abrir</button>
          </div>
          <div class="master-settings-card" data-view="precificacao-taxas">
            <span class="master-settings-icon">üìê</span>
            <h3>Taxas da maquininha</h3>
            <p>Configure as taxas reais do banco. O sistema usa esses dados na precifica√ß√£o dos procedimentos e dos planos para mostrar margem real e como cobrar.</p>
            <button type="button" class="btn-secondary master-card-btn">Abrir</button>
          </div>
          <div class="master-settings-card" data-view="backup">
            <span class="master-settings-icon">üíæ</span>
            <h3>Backup</h3>
            <p>Baixar backup completo ou restaurar dados.</p>
            <button type="button" class="btn-secondary master-card-btn">Abrir</button>
          </div>
          <div class="master-settings-card" data-view="auditoria">
            <span class="master-settings-icon">üìú</span>
            <h3>Auditoria</h3>
            <p>Registro de a√ß√µes da equipe na organiza√ß√£o.</p>
            <button type="button" class="btn-secondary master-card-btn">Abrir</button>
          </div>
          <div class="master-settings-card" data-view="documentos-termos">
            <span class="master-settings-icon">üìã</span>
            <h3>Documentos e termos</h3>
            <p>Pol√≠tica de privacidade, termo LGPD, contrato de presta√ß√£o de servi√ßos e pol√≠ticas. Essencial para defesa judicial.</p>
            <button type="button" class="btn-secondary master-card-btn">Abrir</button>
          </div>
          <div class="master-settings-card" data-view="analise-pele">
            <span class="master-settings-icon">üî¨</span>
            <h3>An√°lises de pele (portal)</h3>
            <p>An√°lises enviadas pelos clientes; validar e incorporar √† anamnese.</p>
            <button type="button" class="btn-secondary master-card-btn">Abrir</button>
          </div>
          <div class="master-settings-card" id="masterCardPagamento" data-view="pagamento">
            <span class="master-settings-icon">üí≥</span>
            <h3>Pagamento pelo app</h3>
            <p>Taxa melhor negociada em volume e ganho vindo da operadora.</p>
            <button type="button" class="btn-secondary master-card-btn">Abrir</button>
          </div>
          <div class="master-settings-card master-settings-card--wide" id="masterCardEquipe">
            <span class="master-settings-icon">üë•</span>
            <h3>Equipe e convites</h3>
            <p><strong id="masterTotalUsers">0</strong> usu√°rio(s) na organiza√ß√£o. Convites pendentes:</p>
            <ul id="masterListaConvites" class="master-convites-list"></ul>
            <a href="#" data-view="team" class="btn-secondary master-card-btn">Ir para Equipe</a>
          </div>
          <div class="master-settings-card master-settings-card--wide" id="masterCardVisao">
            <span class="master-settings-icon">üìä</span>
            <h3>Vis√£o geral (esta organiza√ß√£o)</h3>
            <div class="master-metrics-row">
              <span>Clientes: <strong id="masterMClientes">‚Äî</strong></span>
              <span>Agenda hoje: <strong id="masterMAgenda">‚Äî</strong></span>
              <span>Faturamento m√™s: <strong id="masterMSaldo">‚Äî</strong></span>
            </div>
            <div id="masterCompareWrap" class="master-compare-wrap hidden">
              <h4>Comparativo (todas as organiza√ß√µes)</h4>
              <div class="master-compare-table-wrap">
                <table class="master-compare-table">
                  <thead><tr><th>Organiza√ß√£o</th><th>Clientes</th><th>Faturamento</th></tr></thead>
                  <tbody id="masterCompareTable"></tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      <section id="view-pagamento" class="view hidden">
        <div id="pagamentoContent"></div>
      </section>
    </main>

    <!-- Modo tutorial: cart√£o fixo com passo a passo -->
    <div id="tutorialWrap" class="tutorial-wrap hidden" aria-hidden="true" role="dialog" aria-label="Tutorial do app">
      <div class="tutorial-card">
        <p id="tutorialProgress" class="tutorial-progress" aria-live="polite"></p>
        <h3 id="tutorialTitle" class="tutorial-title"></h3>
        <p id="tutorialBody" class="tutorial-body"></p>
        <div class="tutorial-actions">
          <button type="button" id="tutorialBtnPrev" class="btn-secondary tutorial-btn-prev">Anterior</button>
          <button type="button" id="tutorialBtnNext" class="btn-primary">Pr√≥ximo</button>
          <button type="button" id="tutorialBtnSkip" class="btn-secondary tutorial-btn-skip">Pular tutorial</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Copilot: bot√£o flutuante + painel no canto inferior direito -->
  <button type="button" id="copilotFab" class="copilot-fab" aria-label="Abrir Copilot" title="Perguntar ao Copilot">ü§ñ</button>
  <div id="copilotPanel" class="copilot-panel hidden" role="dialog" aria-label="Copilot ‚Äî Esclarecer d√∫vidas">
    <div class="copilot-panel-header">
      <span class="copilot-panel-title">ü§ñ Copilot</span>
      <button type="button" class="copilot-panel-close" id="copilotPanelClose" aria-label="Fechar">√ó</button>
    </div>
    <div class="copilot-panel-context" id="copilotPanelContext"></div>
    <div class="copilot-panel-chat" id="copilotPanelChat"></div>
    <div class="copilot-panel-input-wrap">
      <textarea id="copilotPanelInput" rows="2" placeholder="Pergunte algo sobre esta notifica√ß√£o ou dados da cl√≠nica‚Ä¶" autocomplete="off"></textarea>
      <button type="button" id="copilotPanelSend" class="copilot-panel-send-btn" aria-label="Enviar">Enviar</button>
    </div>
  </div>

</div>

<!-- MODAL GLOBAL -->
<div id="modal" class="modal hidden">
  <div class="modal-card">
    <h3 id="modalTitle"></h3>
    <form id="modalForm">
      <div id="modalFields"></div>
      <button type="submit" class="btn-primary">Salvar</button>
      <button type="button" class="btn-secondary" id="modalCancel">Cancelar</button>
    </form>
  </div>
  <!-- Form de convite n√£o usado aqui: convite √© feito pelo modal em Equipe > Convidar usu√°rio -->
  <form id="inviteForm" class="hidden" aria-hidden="true">
    <label for="inviteEmail" class="sr-only">E-mail do usu√°rio</label>
    <input id="inviteEmail" type="email" placeholder="Email do usu√°rio" required aria-label="E-mail do usu√°rio" />
    <label for="inviteRole" class="sr-only">Fun√ß√£o</label>
    <select id="inviteRole" aria-label="Fun√ß√£o do usu√°rio">
      <option value="funcionario">Funcion√°rio</option>
      <option value="gestor">Gestor</option>
    </select>
    <button type="submit">Convidar</button>
  </form>
  <script type="module" src="./js/views/invite-user.views.js"></script>
</div>

<!-- MODAL DE CONFIRMA√á√ÉO (ex.: sair) -->
<div id="confirmModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="confirmTitle" aria-describedby="confirmMessage">
  <div class="modal-card modal-card--confirm">
    <h3 id="confirmTitle"></h3>
    <p id="confirmMessage" class="confirm-message"></p>
    <div class="modal-actions">
      <button type="button" id="confirmCancel" class="btn-secondary">Cancelar</button>
      <button type="button" id="confirmOk" class="btn-primary">Confirmar</button>
    </div>
  </div>
</div>

<script type="module" src="./js/core/spa.js"></script>

</body>
</html>
